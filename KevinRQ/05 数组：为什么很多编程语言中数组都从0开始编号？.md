# 05 | 数组：为什么很多编程语言中数组都从0开始编号？

## 定义：
&emsp;&emsp;数组是一种线性表数据结构。用一组连续的内存空间，来存储一组具有相同类型的数据。

### 线性表（Linear List）
&emsp;&emsp;线性表就是数据排成像一条线一样的结构。每个线性表上的数据最多只有前和后两个方向。除了数组，链表、队列、栈等也是线性结构。  
![线性表](https://markdown-bucket.oss-cn-shenzhen.aliyuncs.com/image/BeautyOfDataStructureAndAlgorithms/LinearList.png)

### 非线性表
&emsp;&emsp;如：二叉树、堆、图等。非线性表的数据之间不是简单的前后关系。  
![非线性表](https://markdown-bucket.oss-cn-shenzhen.aliyuncs.com/image/BeautyOfDataStructureAndAlgorithms/NolinearList.png)

### 连续的内存空间、相同类型的数据
&emsp;&emsp;可随机访问。删除、插入数据低效，为了保证数组的连续性，要做大量的数据搬移工作。  

#### 低效的“插入” 和 “删除”

##### 插入操作：
&emsp;&emsp;要将一个数据插入到数组中的第k个位置，需要把第 k~n 的元素都顺序地往后挪，平均情况复杂度为 `(1+2+...n)/n = O(n)`。  
&emsp;&emsp;另一个简单的处理办法：直接将第k位的数据搬移到数组最后，把新的元素直接放入第k个位置。这时时间复杂度降为O(1)。  

##### 删除操作：
&emsp;&emsp;为了内存的连续性，也需要搬移数据。平均复杂度也为O(n)。  
&emsp;&emsp;其他处理方式：先记录下已经删除的数据。当数组没有更多空间存储数据时，再触发执行一次真正的删除操作，这样大大减少数据搬移工作。  


## 数组的访问越界问题
&emsp;&emsp;C语言中，只要不是访问受限的内存，所有的内存空间都是可以自由访问的。访问数组的本质就是访问一段连续的内存，只要数组通过偏移计算得到的内存地址可用，程序就可能不会报任何错误。  
&emsp;&emsp;Java语言中，Java本身就会做越界检查。  

## 容器能否完全替代数组
**Java中的ArrayList举例：**  
&emsp;&emsp;ArrayList的最大优势是 **可以将很多数组操作的细节封装起来**，如 插入删除数据时的数据搬移等。  
&emsp;&emsp;另一个优势是 **支持动态扩容**：不需要关心底层的扩容逻辑，存储空间不够时，ArrayList会自动扩容为1.5倍大小。  
&emsp;&emsp;&emsp;&emsp;因为扩容操作涉及耗时的内存申请和数据搬移，所以，如果能事先确定要存储的数据大小，最好创建ArrayList时就指定数据大小。  

<br/>
**数组适用情况：**  
1. Java ArrayList无法存储基本类型，如int、long，需要封装为Integer、Long类，而Autoboxing、Unboxing有一定的性能消耗，如特别关注性能 或希望使用基本类型，可选用数组。  
2. 如果数据大小已知，且数据操作简单，也可直接使用数组。
3. 表示多维数组时，用数组可能更加直观。  

**总结：**  
&emsp;&emsp;业务开发 直接使用容器就足够了。  
&emsp;&emsp;若是非常底层的开发，如开发网络框架，注重性能优化，这时数组就是首选。

**数组从0开始编号原因解答：**  
- 数组的“下标” 的定义就是 “偏移”，数组元素的内存地址计算为 数组首地址 加上 偏移。如果从1开始编号，每次随机访问数组元素都要多一次减法运算。  
- 历史原因:  
&emsp;&emsp;C语言使用0开始，之后的Java、JavaScript等高级语言效仿。  
&emsp;&emsp;例外：Matlab从1开始计数；Python支持负数下标。